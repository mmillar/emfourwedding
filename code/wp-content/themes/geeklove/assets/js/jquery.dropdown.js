/*! Dropdown for Select */
(function(b,a,c){b.DropDown=function(d,e){this.$el=b(e);this._init(d)};b.DropDown.defaults={speed:300,easing:"ease",gutter:0,stack:true,delay:0,random:false,rotated:false,slidingIn:false,onOptionSelect:function(d){return false}};b.DropDown.prototype={_init:function(d){this.options=b.extend(true,{},b.DropDown.defaults,d);this._layout();this._initEvents()},_layout:function(){var d=this;this.minZIndex=1000;var g=this._transformSelect();this.opts=this.listopts.children("li");this.optsCount=this.opts.length;this.size={width:this.dd.width(),height:this.dd.height()};var h=this.$el.attr("name"),f=this.$el.attr("id"),e=h!==c?h:f!==c?f:"cd-dropdown-"+(new Date()).getTime();this.inputEl=b('<input type="hidden" name="'+e+'" value="'+g+'"></input>').insertAfter(this.selectlabel);this.selectlabel.css("z-index",this.minZIndex+this.optsCount);this._positionOpts();if(Modernizr.csstransitions){setTimeout(function(){d.opts.css("transition","all "+d.options.speed+"ms "+d.options.easing)},25)}},_transformSelect:function(){var f="",d="",e=-1;this.$el.children("option").each(function(){var j=b(this),k=isNaN(j.attr("value"))?j.attr("value"):Number(j.attr("value")),h=j.attr("class"),i=j.attr("selected"),g=j.text();if(k!==-1){f+=h!==c?'<li data-value="'+k+'"><span class="'+h+'">'+g+"</span></li>":'<li data-value="'+k+'"><span>'+g+"</span></li>"}if(i){d=g;e=k}});this.listopts=b("<ul/>").append(f);this.selectlabel=b("<span/>").append(d);this.dd=b('<div class="cd-dropdown"/>').append(this.selectlabel,this.listopts).insertAfter(this.$el);this.$el.remove();return e},_positionOpts:function(e){var d=this;this.listopts.css("height","auto");this.opts.each(function(f){b(this).css({zIndex:d.minZIndex+d.optsCount-1-f,top:d.options.slidingIn?(f+1)*(d.size.height+d.options.gutter):0,left:0,marginLeft:d.options.slidingIn?f%2===0?d.options.slidingIn:-d.options.slidingIn:0,opacity:d.options.slidingIn?0:1,transform:"none"})});if(!this.options.slidingIn){this.opts.eq(this.optsCount-1).css({top:this.options.stack?9:0,left:this.options.stack?4:0,width:this.options.stack?this.size.width-8:this.size.width,transform:"none"}).end().eq(this.optsCount-2).css({top:this.options.stack?6:0,left:this.options.stack?2:0,width:this.options.stack?this.size.width-4:this.size.width,transform:"none"}).end().eq(this.optsCount-3).css({top:this.options.stack?3:0,left:0,transform:"none"})}},_initEvents:function(){var d=this;this.selectlabel.on("mousedown.dropdown",function(e){d.opened?d.close():d.open();return false});this.opts.on("click.dropdown",function(){if(d.opened){var e=b(this);d.options.onOptionSelect(e);d.inputEl.val(e.data("value"));d.selectlabel.html(e.html());d.close()}})},open:function(){var d=this;this.dd.toggleClass("cd-active");this.listopts.css("height",(this.optsCount+1)*(this.size.height+this.options.gutter));this.opts.each(function(e){b(this).css({opacity:1,top:d.options.rotated?d.size.height+d.options.gutter:(e+1)*(d.size.height+d.options.gutter),left:d.options.random?Math.floor(Math.random()*11-5):0,width:d.size.width,marginLeft:0,transform:d.options.random?"rotate("+Math.floor(Math.random()*11-5)+"deg)":d.options.rotated?d.options.rotated==="right"?"rotate(-"+(e*5)+"deg)":"rotate("+(e*5)+"deg)":"none",transitionDelay:d.options.delay&&Modernizr.csstransitions?d.options.slidingIn?(e*d.options.delay)+"ms":((d.optsCount-1-e)*d.options.delay)+"ms":0})});this.opened=true},close:function(){var d=this;this.dd.toggleClass("cd-active");if(this.options.delay&&Modernizr.csstransitions){this.opts.each(function(e){b(this).css({"transition-delay":d.options.slidingIn?((d.optsCount-1-e)*d.options.delay)+"ms":(e*d.options.delay)+"ms"})})}this._positionOpts(true);this.opened=false}};b.fn.dropdown=function(f){var d=b.data(this,"dropdown");if(typeof f==="string"){var e=Array.prototype.slice.call(arguments,1);this.each(function(){d[f].apply(d,e)})}else{this.each(function(){d?d._init():d=b.data(this,"dropdown",new b.DropDown(f,this))})}return d}})(jQuery,window);
